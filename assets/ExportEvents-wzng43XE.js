import{r as b,p as e,o as M,A as E,q as U,aG as O,f as _,s as B,i as N,t as z,D as j,U as G,v as l,P,w as u,V as w,Q as T,aw as F,ai as H,a9 as V,al as q}from"./index-DqsZ9Gql.js";import{s as J,u as Q,L as K,S as X,B as D,b as Y,a as Z,C as W,E as $}from"./Error-Dx8yQfb8.js";import{g as ee}from"./listItemIconClasses-DPYJkFoR.js";import{L as te}from"./ListItemText-DyutVEBd.js";const oe=O(),se=J("div",{name:"MuiContainer",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:n}=s;return[o.root,o[`maxWidth${E(String(n.maxWidth))}`],n.fixed&&o.fixed,n.disableGutters&&o.disableGutters]}}),ne=s=>Q({props:s,name:"MuiContainer",defaultTheme:oe}),ae=(s,o)=>{const n=p=>_(o,p),{classes:d,fixed:h,disableGutters:g,maxWidth:t}=s,r={root:["root",t&&`maxWidth${E(String(t))}`,h&&"fixed",g&&"disableGutters"]};return U(r,n,d)};function re(s={}){const{createStyledComponent:o=se,useThemeProps:n=ne,componentName:d="MuiContainer"}=s,h=o(({theme:t,ownerState:r})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!r.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}}),({theme:t,ownerState:r})=>r.fixed&&Object.keys(t.breakpoints.values).reduce((p,a)=>{const m=a,i=t.breakpoints.values[m];return i!==0&&(p[t.breakpoints.up(m)]={maxWidth:`${i}${t.breakpoints.unit}`}),p},{}),({theme:t,ownerState:r})=>({...r.maxWidth==="xs"&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},...r.maxWidth&&r.maxWidth!=="xs"&&{[t.breakpoints.up(r.maxWidth)]:{maxWidth:`${t.breakpoints.values[r.maxWidth]}${t.breakpoints.unit}`}}}));return b.forwardRef(function(r,p){const a=n(r),{className:m,component:i="div",disableGutters:y=!1,fixed:C=!1,maxWidth:S="lg",classes:I,...k}=a,v={...a,component:i,disableGutters:y,fixed:C,maxWidth:S},x=ae(v,d);return e(h,{as:i,ownerState:v,className:M(x.root,m),ref:p,...k})})}const ie=re({createStyledComponent:B("div",{name:"MuiContainer",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:n}=s;return[o.root,o[`maxWidth${E(String(n.maxWidth))}`],n.fixed&&o.fixed,n.disableGutters&&o.disableGutters]}}),useThemeProps:s=>N({props:s,name:"MuiContainer"})}),ce=s=>{const{alignItems:o,classes:n}=s;return U({root:["root",o==="flex-start"&&"alignItemsFlexStart"]},ee,n)},le=B("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:n}=s;return[o.root,n.alignItems==="flex-start"&&o.alignItemsFlexStart]}})(z(({theme:s})=>({minWidth:56,color:(s.vars||s).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),de=b.forwardRef(function(o,n){const d=N({props:o,name:"MuiListItemIcon"}),{className:h,...g}=d,t=b.useContext(K),r={...d,alignItems:t.alignItems},p=ce(r);return e(le,{className:M(p.root,h),ownerState:r,ref:n,...g})}),ue=j(e("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),pe=j(e("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"})),me="economicEvents",A=["mql5","forex-factory","fxstreet"];function ve(){const{user:s}=G(),[o,n]=b.useState(!1),[d,h]=b.useState(null),[g,t]=b.useState(null),r=async()=>{n(!0),t(null),h(null);try{console.log("ðŸ“Š Starting export of economic events from all sources...");const a=[];let m=0;for(const i of A){console.log(`ðŸ“¥ Exporting ${i}...`);const y=H(V,me,i,"events"),C=await q(y),S=C.size;if(C.empty){console.warn(`âš ï¸ No events found for ${i}`),a.push({source:i,count:0,success:!1});continue}const I=C.docs.map(x=>{var f,L,R;const c=x.data();return{id:x.id,source:i,...c,date:(f=c.date)!=null&&f.toDate?{_seconds:Math.floor(c.date.toDate().getTime()/1e3),_nanoseconds:c.date.toDate().getTime()%1e3*1e6}:c.date,createdAt:(L=c.createdAt)!=null&&L.toDate?{_seconds:Math.floor(c.createdAt.toDate().getTime()/1e3),_nanoseconds:c.createdAt.toDate().getTime()%1e3*1e6}:c.createdAt,updatedAt:(R=c.updatedAt)!=null&&R.toDate?{_seconds:Math.floor(c.updatedAt.toDate().getTime()/1e3),_nanoseconds:c.updatedAt.toDate().getTime()%1e3*1e6}:c.updatedAt}});console.log(`âœ… Exported ${I.length} events from ${i}`),m+=I.length;const k=JSON.stringify(I,null,2),v=`${i}-events-${new Date().toISOString().split("T")[0]}.json`;try{const x=new Blob([k],{type:"application/json"}),c=URL.createObjectURL(x),f=document.createElement("a");f.href=c,f.download=v,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(c),a.push({source:i,count:S,success:!0,filename:v})}catch(x){console.error(`Failed to save ${v}:`,x),a.push({source:i,count:S,success:!1,filename:v})}}h({success:!0,sources:a,totalCount:m,timestamp:new Date().toISOString()})}catch(a){console.error("âŒ Export failed:",a),t(a.message||"Failed to export events")}finally{n(!1)}};return e(ie,{maxWidth:"md",sx:{py:8},children:l(P,{elevation:3,sx:{p:4},children:[l(X,{direction:"row",spacing:2,alignItems:"center",sx:{mb:4},children:[e(D,{variant:"outlined",startIcon:e(ue,{}),onClick:()=>{window.location.hash="/"},sx:{minWidth:"auto"},children:"Back"}),e(u,{variant:"h4",component:"h1",sx:{flexGrow:1},children:"Export Economic Events"})]}),s&&e(w,{severity:"info",sx:{mb:3},children:l(u,{variant:"body2",children:["Logged in as: ",e("strong",{children:s.email})]})}),e(u,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Export economic events from all news sources to separate JSON files. This will download 3 files (one per source) containing all events with their metadata including dates, currencies, impact levels, and event details."}),l(u,{variant:"body2",color:"text.secondary",sx:{mb:3},children:[e("strong",{children:"Sources:"})," ",A.map(a=>a.toUpperCase()).join(", ")]}),e(T,{sx:{my:4},children:e(D,{variant:"contained",color:"primary",size:"large",startIcon:o?e(F,{size:20,color:"inherit"}):e(pe,{}),onClick:r,disabled:o,fullWidth:!0,sx:{py:1.5},children:o?"Exporting All Sources...":"Export All Sources (3 Files)"})}),d&&l(w,{severity:"success",icon:e(W,{}),sx:{mb:2},children:[e(u,{variant:"subtitle2",gutterBottom:!0,children:"Export completed successfully!"}),l(u,{variant:"body2",sx:{mb:2},children:["Downloaded ",d.sources.filter(a=>a.success).length," files with ",d.totalCount.toLocaleString()," total events"]}),e(Y,{dense:!0,sx:{bgcolor:"success.light",borderRadius:1,py:.5},children:d.sources.map(({source:a,count:m,success:i,filename:y})=>l(Z,{dense:!0,children:[e(de,{sx:{minWidth:36},children:i?e(W,{color:"success",fontSize:"small"}):e($,{color:"error",fontSize:"small"})}),e(te,{primary:l(u,{variant:"body2",children:[l("strong",{children:[a.replace("-"," ").toUpperCase(),":"]})," ",m.toLocaleString()," events"]}),secondary:y||`${a}-events-${new Date(d.timestamp).toISOString().split("T")[0]}.json`})]},a))}),l(w,{severity:"info",sx:{mt:2},children:[e(u,{variant:"caption",display:"block",gutterBottom:!0,children:e("strong",{children:"ðŸ“¥ Files downloaded to your Downloads folder"})}),l(u,{variant:"caption",display:"block",children:["Move them to: ",e("code",{children:"D:\\Lofi Trades\\trading-clock\\data\\"})]})]})]}),g&&l(w,{severity:"error",icon:e($,{}),onClose:()=>t(null),children:[e(u,{variant:"subtitle2",gutterBottom:!0,children:"Export failed"}),e(u,{variant:"body2",children:g})]}),l(T,{sx:{mt:4,p:2,bgcolor:"background.default",borderRadius:1},children:[e(u,{variant:"caption",color:"text.secondary",display:"block",gutterBottom:!0,children:e("strong",{children:"Export Details:"})}),l(u,{variant:"caption",color:"text.secondary",display:"block",sx:{ml:2},children:["â€¢ 3 files will be downloaded (one per source)",e("br",{}),"â€¢ Timestamps preserved in Firestore format (_seconds, _nanoseconds)",e("br",{}),"â€¢ Files automatically downloaded to your Downloads folder",e("br",{}),"â€¢ Move files to ",e("code",{children:"data/"})," folder to replace old exports",e("br",{}),"â€¢ File naming: ",l("code",{children:["{source}","-events-","{date}",".json"]})]})]})]})})}export{ve as default};
