import{f as me,h as fe,r as p,i as ie,z as be,v as n,s as R,p as a,o as le,A as x,q as ce,t as O,E,G as Y,H as Z,n as q,w as u,au as oe,D as de,Q as $,P as W,V as A,a8 as ne,a9 as H,a7 as ye,av as se,aw as he}from"./index-wEGG5XMx.js";import{L as ge,D as ve,p as D,q as xe,E as Ce,y as Pe,x as Se}from"./TextField-B7bx01SS.js";import{B as _,a as Ie,S as we,C as J}from"./CheckCircle-DDP9-3ts.js";import{E as Le}from"./Error-DqQLnIGC.js";function $e(r){return me("MuiLinearProgress",r)}fe("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const V=4,X=Z`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,ke=typeof X!="string"?Y`
        animation: ${X} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,G=Z`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Be=typeof G!="string"?Y`
        animation: ${G} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,Q=Z`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Te=typeof Q!="string"?Y`
        animation: ${Q} 3s infinite linear;
      `:null,Ee=r=>{const{classes:e,variant:t,color:s}=r,f={root:["root",`color${x(s)}`,t],dashed:["dashed",`dashedColor${x(s)}`],bar1:["bar","bar1",`barColor${x(s)}`,(t==="indeterminate"||t==="query")&&"bar1Indeterminate",t==="determinate"&&"bar1Determinate",t==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",t!=="buffer"&&`barColor${x(s)}`,t==="buffer"&&`color${x(s)}`,(t==="indeterminate"||t==="query")&&"bar2Indeterminate",t==="buffer"&&"bar2Buffer"]};return ce(f,$e,e)},ee=(r,e)=>r.vars?r.vars.palette.LinearProgress[`${e}Bg`]:r.palette.mode==="light"?r.lighten(r.palette[e].main,.62):r.darken(r.palette[e].main,.5),Re=R("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.root,e[`color${x(t.color)}`],e[t.variant]]}})(O(({theme:r})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(r.palette).filter(E()).map(([e])=>({props:{color:e},style:{backgroundColor:ee(r,e)}})),{props:({ownerState:e})=>e.color==="inherit"&&e.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),ze=R("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.dashed,e[`dashedColor${x(t.color)}`]]}})(O(({theme:r})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(r.palette).filter(E()).map(([e])=>{const t=ee(r,e);return{props:{color:e},style:{backgroundImage:`radial-gradient(${t} 0%, ${t} 16%, transparent 42%)`}}})]})),Te||{animation:`${Q} 3s infinite linear`}),Fe=R("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.bar,e.bar1,e[`barColor${x(t.color)}`],(t.variant==="indeterminate"||t.variant==="query")&&e.bar1Indeterminate,t.variant==="determinate"&&e.bar1Determinate,t.variant==="buffer"&&e.bar1Buffer]}})(O(({theme:r})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(r.palette).filter(E()).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main}})),{props:{variant:"determinate"},style:{transition:`transform .${V}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${V}s linear`}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:{width:"auto"}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:ke||{animation:`${X} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),Ne=R("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.bar,e.bar2,e[`barColor${x(t.color)}`],(t.variant==="indeterminate"||t.variant==="query")&&e.bar2Indeterminate,t.variant==="buffer"&&e.bar2Buffer]}})(O(({theme:r})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(r.palette).filter(E()).map(([e])=>({props:{color:e},style:{"--LinearProgressBar2-barColor":(r.vars||r).palette[e].main}})),{props:({ownerState:e})=>e.variant!=="buffer"&&e.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:e})=>e.variant!=="buffer"&&e.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(r.palette).filter(E()).map(([e])=>({props:{color:e,variant:"buffer"},style:{backgroundColor:ee(r,e),transition:`transform .${V}s linear`}})),{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:{width:"auto"}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:Be||{animation:`${G} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),Ue=p.forwardRef(function(e,t){const s=ie({props:e,name:"MuiLinearProgress"}),{className:f,color:C="primary",value:l,valueBuffer:I,variant:c="indeterminate",...w}=s,b={...s,color:C,variant:c},g=Ee(b),P=be(),y={},v={bar1:{},bar2:{}};if((c==="determinate"||c==="buffer")&&l!==void 0){y["aria-valuenow"]=Math.round(l),y["aria-valuemin"]=0,y["aria-valuemax"]=100;let i=l-100;P&&(i=-i),v.bar1.transform=`translateX(${i}%)`}if(c==="buffer"&&I!==void 0){let i=(I||0)-100;P&&(i=-i),v.bar2.transform=`translateX(${i}%)`}return n(Re,{className:le(g.root,f),ownerState:b,role:"progressbar",...y,ref:t,...w,children:[c==="buffer"?a(ze,{className:g.dashed,ownerState:b}):null,a(Fe,{className:g.bar1,ownerState:b,style:v.bar1}),c==="determinate"?null:a(Ne,{className:g.bar2,ownerState:b,style:v.bar2})]})}),Ae=r=>{const{classes:e,inset:t,primary:s,secondary:f,dense:C}=r;return ce({root:["root",t&&"inset",C&&"dense",s&&f&&"multiline"],primary:["primary"],secondary:["secondary"]},ve,e)},De=R("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[{[`& .${D.primary}`]:e.primary},{[`& .${D.secondary}`]:e.secondary},e.root,t.inset&&e.inset,t.primary&&t.secondary&&e.multiline,t.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${oe.root}:where(& .${D.primary})`]:{display:"block"},[`.${oe.root}:where(& .${D.secondary})`]:{display:"block"},variants:[{props:({ownerState:r})=>r.primary&&r.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:r})=>r.inset,style:{paddingLeft:56}}]}),Oe=p.forwardRef(function(e,t){const s=ie({props:e,name:"MuiListItemText"}),{children:f,className:C,disableTypography:l=!1,inset:I=!1,primary:c,primaryTypographyProps:w,secondary:b,secondaryTypographyProps:g,slots:P={},slotProps:y={},...v}=s,{dense:i}=p.useContext(ge);let m=c??f,h=b;const L={...s,disableTypography:l,inset:I,primary:!!m,secondary:!!h,dense:i},k=Ae(L),B={slots:P,slotProps:{primary:w,secondary:g,...y}},[M,o]=q("root",{className:le(k.root,C),elementType:De,externalForwardedProps:{...B,...v},ownerState:L,ref:t}),[d,S]=q("primary",{className:k.primary,elementType:u,externalForwardedProps:B,ownerState:L}),[z,F]=q("secondary",{className:k.secondary,elementType:u,externalForwardedProps:B,ownerState:L});return m!=null&&m.type!==u&&!l&&(m=a(d,{variant:i?"body2":"body1",component:S!=null&&S.variant?void 0:"span",...S,children:m})),h!=null&&h.type!==u&&!l&&(h=a(z,{variant:"body2",color:"textSecondary",...F,children:h})),n(M,{...o,children:[m,h]})}),Me=de(a("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8z"})),je=de(a("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"})),K="economicEventDescriptions";function qe(r){return r.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"").substring(0,100)}function Ke(){const[r,e]=p.useState(!1),[t,s]=p.useState(""),[f,C]=p.useState(""),[l,I]=p.useState(null),[c,w]=p.useState(!1),[b,g]=p.useState(0),[P,y]=p.useState(null),[v,i]=p.useState(null),[m,h]=p.useState([]),L="9876543210",k=o=>{o.preventDefault(),t===L?(e(!0),C("")):(C("Incorrect password. Please try again."),s(""))},B=o=>{const d=o.target.files[0];d&&(d.type==="application/json"?(I(d),i(null),y(null),h([])):(i("Please select a valid JSON file"),I(null)))},M=async()=>{if(!l){i("Please select a file first");return}w(!0),i(null),g(0),h([]);try{const o=await l.text(),d=JSON.parse(o);if(!d.events||!Array.isArray(d.events))throw new Error('Invalid JSON structure: missing "events" array');const S=d.events,z=S.length,F=[],pe=ne(H,K,"_metadata");await ye(pe,{...d.metadata,uploadedAt:se(),uploadedBy:"admin",totalEvents:z});const re=500;let N=0;for(let U=0;U<S.length;U+=re){const te=he(H),ae=S.slice(U,U+re);for(const T of ae){const j=qe(T.name),ue=ne(H,K,j);te.set(ue,{...T,docId:j,uploadedAt:se()},{merge:!0}),F.push({name:T.name,category:T.category,impact:T.impact,docId:j})}await te.commit(),N+=ae.length,g(N/z*100)}h(F),y({success:!0,message:`Successfully uploaded ${N} event descriptions to Firestore`,count:N})}catch(o){console.error("Upload error:",o),i(o.message||"Failed to upload descriptions"),y({success:!1,message:"Upload failed"})}finally{w(!1)}};return r?a($,{sx:{minHeight:"100vh",bgcolor:"background.default",p:4},children:n(W,{elevation:3,sx:{maxWidth:800,mx:"auto",p:4},children:[a(u,{variant:"h4",gutterBottom:!0,sx:{mb:3},children:"Upload Economic Event Descriptions"}),n(u,{variant:"body1",color:"text.secondary",sx:{mb:4},children:["Select the ",a("code",{children:"economicEventDescriptions.json"})," file to upload event descriptions to Firestore."]}),n($,{sx:{mb:3},children:[a(Ce,{type:"file",inputProps:{accept:".json"},onChange:B,sx:{display:"none"},id:"file-upload-input"}),a("label",{htmlFor:"file-upload-input",children:a(_,{variant:"outlined",component:"span",startIcon:a(Me,{}),disabled:c,fullWidth:!0,sx:{mb:2},children:"Select JSON File"})}),l&&n(A,{severity:"info",sx:{mb:2},children:["Selected: ",a("strong",{children:l.name})," (",(l.size/1024).toFixed(2)," KB)"]})]}),a(_,{variant:"contained",color:"primary",startIcon:a(je,{}),onClick:M,disabled:!l||c,fullWidth:!0,sx:{mb:3},children:c?"Uploading...":"Upload to Firestore"}),c&&n($,{sx:{mb:3},children:[a(Ue,{variant:"determinate",value:b}),n(u,{variant:"body2",color:"text.secondary",align:"center",sx:{mt:1},children:[Math.round(b),"% Complete"]})]}),v&&a(A,{severity:"error",icon:a(Le,{}),sx:{mb:3},children:v}),P&&P.success&&a(A,{severity:"success",icon:a(Ie,{}),sx:{mb:3},children:P.message}),m.length>0&&n($,{sx:{mt:4},children:[n(u,{variant:"h6",gutterBottom:!0,children:["Uploaded Events (",m.length,")"]}),a(W,{variant:"outlined",sx:{maxHeight:400,overflow:"auto",p:2},children:a(Pe,{dense:!0,children:m.map((o,d)=>a(Se,{divider:d<m.length-1,children:a(Oe,{primary:o.name,secondary:n(we,{direction:"row",spacing:1,sx:{mt:.5},children:[a(J,{label:o.category,size:"small",variant:"outlined"}),a(J,{label:o.impact,size:"small",color:o.impact==="high"?"error":o.impact==="medium"?"warning":"default"}),a(J,{label:o.docId,size:"small",variant:"outlined",sx:{fontFamily:"monospace",fontSize:"0.7rem"}})]})})},d))})})]}),n($,{sx:{mt:4,p:2,bgcolor:"background.paper",borderRadius:1},children:[a(u,{variant:"subtitle2",gutterBottom:!0,children:"Instructions:"}),a(u,{variant:"body2",color:"text.secondary",component:"div",children:n("ol",{style:{margin:0,paddingLeft:20},children:[n("li",{children:['Click "Select JSON File" and choose ',a("code",{children:"economicEventDescriptions.json"})]}),a("li",{children:'Click "Upload to Firestore" to start the upload'}),a("li",{children:"Wait for the upload to complete"}),n("li",{children:["The events will be stored in the ",a("code",{children:K})," collection"]})]})})]})]})}):a($,{sx:{minHeight:"100vh",bgcolor:"background.default",display:"flex",alignItems:"center",justifyContent:"center",p:4},children:n(W,{elevation:3,sx:{maxWidth:400,width:"100%",p:4},children:[a(u,{variant:"h5",gutterBottom:!0,sx:{mb:3,textAlign:"center"},children:"Protected Page"}),a(u,{variant:"body2",color:"text.secondary",sx:{mb:3,textAlign:"center"},children:"Please enter the password to access the upload page."}),n("form",{onSubmit:k,children:[a(xe,{type:"password",value:t,onChange:o=>s(o.target.value),placeholder:"Enter password",fullWidth:!0,autoFocus:!0,variant:"outlined",sx:{mb:2}}),f&&a(A,{severity:"error",sx:{mb:2},children:f}),a(_,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Submit"})]})]})})}export{Ke as default};
