{
  "__fileHeader": {
    "path": "firebase.json",
    "purpose": "Firebase Hosting and Functions configuration for Time 2 Trade frontend/backend deployment.",
    "changelog": [
      "v1.6.0 - 2026-01-30 - BEP SEO FIX: Reverted rewrites to simple '**' catch-all pattern. Firebase Hosting serves exact-match static files (ads.txt, robots.txt, sitemap.xml) BEFORE processing rewrites per official priority order. The negation pattern was unnecessary and non-standard. Static files in dist/ are automatically served at step 3, rewrites only apply when files don't exist (step 4). This follows Firebase Hosting BEP and ensures ads.txt is crawlable by Google AdSense.",
      "v1.5.0 - 2026-01-28 - BEP FIX: Rewrites now serve prerendered subpages (/es/contact, /fr/about, etc.) correctly. Each language route pattern serves its own index.html, enabling SEO for all localized pages.",
      "v1.4.0 - 2026-01-27 - BEP ENHANCED i18n: Added rewrites for /es/* and /fr/* language subpaths. Multi-language prerendered HTML files now serve with proper language parameter. Enables non-JS crawlers to see localized content immediately.",
      "v1.3.0 - 2026-01-27 - BEP CONSOLE FIX: Added Cross-Origin-Opener-Policy: unsafe-none header to all responses. Fixes Firebase Auth SDK warning 'COOP policy would block window.closed call'. Firebase popup auth needs to check window.closed from auth popup window, which COOP: same-origin policy would block.",
      "v1.2.0 - 2025-12-17 - Added static file headers for robots.txt and sitemap.xml for SEO.",
      "v1.1.0 - 2025-12-16 - Added immutable cache headers for JS/CSS and retained SPA rewrite for custom domain hosting.",
      "v1.0.0 - 2025-12-16 - Initial configuration with hosting, functions, emulators, firestore, and storage settings."
    ]
  },
  "hosting": {
    "public": "dist",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "/es/clock{,/**}",
        "destination": "/es/clock/index.html"
      },
      {
        "source": "/es/calendar{,/**}",
        "destination": "/es/calendar/index.html"
      },
      {
        "source": "/es/about{,/**}",
        "destination": "/es/about/index.html"
      },
      {
        "source": "/es/privacy{,/**}",
        "destination": "/es/privacy/index.html"
      },
      {
        "source": "/es/terms{,/**}",
        "destination": "/es/terms/index.html"
      },
      {
        "source": "/es/contact{,/**}",
        "destination": "/es/contact/index.html"
      },
      {
        "source": "/es{,/**}",
        "destination": "/es/index.html"
      },
      {
        "source": "/fr/clock{,/**}",
        "destination": "/fr/clock/index.html"
      },
      {
        "source": "/fr/calendar{,/**}",
        "destination": "/fr/calendar/index.html"
      },
      {
        "source": "/fr/about{,/**}",
        "destination": "/fr/about/index.html"
      },
      {
        "source": "/fr/privacy{,/**}",
        "destination": "/fr/privacy/index.html"
      },
      {
        "source": "/fr/terms{,/**}",
        "destination": "/fr/terms/index.html"
      },
      {
        "source": "/fr/contact{,/**}",
        "destination": "/fr/contact/index.html"
      },
      {
        "source": "/fr{,/**}",
        "destination": "/fr/index.html"
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ],
    "headers": [
      {
        "source": "**/*.@(js|css)",
        "headers": [
          {
            "key": "Cache-Control",
            "value": "public, max-age=31536000, immutable"
          }
        ]
      },
      {
        "source": "robots.txt",
        "headers": [
          {
            "key": "Content-Type",
            "value": "text/plain"
          },
          {
            "key": "Cache-Control",
            "value": "public, max-age=86400"
          }
        ]
      },
      {
        "source": "sitemap.xml",
        "headers": [
          {
            "key": "Content-Type",
            "value": "application/xml"
          },
          {
            "key": "Cache-Control",
            "value": "public, max-age=86400"
          }
        ]
      },
      {
        "source": "ads.txt",
        "headers": [
          {
            "key": "Content-Type",
            "value": "text/plain"
          },
          {
            "key": "Cache-Control",
            "value": "public, max-age=86400"
          }
        ]
      },
      {
        "source": "**",
        "headers": [
          {
            "key": "Cross-Origin-Opener-Policy",
            "value": "unsafe-none"
          }
        ]
      }
    ]
  },
  "functions": [
    {
      "source": "functions",
      "codebase": "default",
      "disallowLegacyRuntimeConfig": true,
      "ignore": [
        "node_modules",
        ".git",
        "firebase-debug.log",
        "firebase-debug.*.log",
        "*.local"
      ],
      "predeploy": [
        "npm --prefix \"$RESOURCE_DIR\" run build"
      ]
    }
  ],
  "emulators": {
    "functions": {
      "port": 5001
    },
    "firestore": {
      "port": 8080
    },
    "ui": {
      "enabled": true,
      "port": 4000
    }
  },
  "firestore": {
    "database": "(default)",
    "location": "us-central1",
    "rules": "firestore.rules",
    "indexes": "firestore.indexes.json"
  },
  "storage": {
    "rules": "storage.rules"
  }
}
